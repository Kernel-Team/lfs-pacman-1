pkgname=colord
pkgver=1.4.0
pkgrel=1
pkgdesc="System daemon for managing color devices"
arch=('x86_64')
url="https://www.freedesktop.org/wiki/Software/colord/"
license=('GPL2')
#depends=()
options=(emptydirs)
source=("https://www.freedesktop.org/software/colord/releases/colord-${pkgver}.tar.xz"
	"colord.sysusers")

prepare() {
	install -v -dm755 "${srcdir}/build"
}

build() {
	cd "${srcdir}/build"

	meson --prefix /usr \
		--sysconfdir /etc \
		--localstatedir /var \
		--buildtype=plain \
		-Denable-bash-completion=false \
		-Denable-argyllcms-sensor=false \
		-Denable-tests=false \
		-Dwith-daemon-user="colord" \
		"${srcdir}/colord-${pkgver}"

#		-Denable-vala=true \

	ninja ${MAKEFLAGS}
}

package() {
	cd "${srcdir}/build"

	DESTDIR="${pkgdir}" ninja install

	install -v -Dm644 "${srcdir}/colord.sysusers" "${pkgdir}/usr/lib/sysusers.d/colord.conf"

	chown -R 71:71 "${pkgdir}/var/lib/colord"
}

sha512sums=('4733d30bc5277b60c96b035c0aaf7a16243fabfd8769ff743f0ac10279da423f5d00223270e5e5281cced7a2b39a9c477c2da5e3b0db18c642f6710641402849'
            '46d421c626bf135b5cb2c491f3090b15bde6b4a06e5400ccea1e6d455c3fd406364555e34bfdeafac40072d9e64c1a9d9feb07d3dbac8594e83182f5b38eecf8')

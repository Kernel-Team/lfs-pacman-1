pkgname=cups-filters
pkgver=1.17.9
pkgrel=1
pkgdesc="OpenPrinting CUPS Filters"
arch=('x86_64')
url="https://wiki.linuxfoundation.org/openprinting/cups-filters"
license=('custom')
#depends=()
source=("https://www.openprinting.org/download/cups-filters/cups-filters-${pkgver}.tar.xz")

prepare() {
	cd "${srcdir}/cups-filters-${pkgver}"

	sed -i "s:cups.service:org.cups.cupsd.service:g" utils/cups-browsed.service
}

build() {
	cd "${srcdir}/cups-filters-${pkgver}"

	export CXX="${CXX} -std=c++11"

	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--localstatedir=/var \
		--without-rcdir \
		--enable-auto-setup-driverless

	make
}

package() {
	cd "${srcdir}/cups-filters-${pkgver}"

	make install DESTDIR="${pkgdir}"

	install -v -Dm644 utils/cups-browsed.service "${pkgdir}/usr/lib/systemd/system/cups-browsed.service"

	chgrp -R lp "${pkgdir}/etc/cups"
}

sha512sums=('811d2671c660a2129c207d5d8daaa576b027ba14ac4cf4753d0e8c1190866a684e284f1e7439b864aaab332e429befbc13c567bf6c9fc1a502fe2cd7d11e5ed4')

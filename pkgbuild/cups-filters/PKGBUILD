pkgname=cups-filters
pkgver=1.17.5
pkgrel=1
pkgdesc="OpenPrinting CUPS Filters"
arch=('x86_64')
url="https://wiki.linuxfoundation.org/openprinting/cups-filters"
license=('custom')
#depends=()
source=("https://www.openprinting.org/download/cups-filters/cups-filters-${pkgver}.tar.xz")

prepare() {
	cd "${srcdir}/cups-filters-${pkgver}"

	sed -i "s:cups.service:org.cups.cupsd.service:g" utils/cups-browsed.service
}

build() {
	cd "${srcdir}/cups-filters-${pkgver}"

	export CXX="${CXX} -std=c++11"

	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--localstatedir=/var \
		--without-rcdir \
		--enable-auto-setup-driverless

	make
}

package() {
	cd "${srcdir}/cups-filters-${pkgver}"

	make install DESTDIR="${pkgdir}"

	install -v -Dm644 utils/cups-browsed.service "${pkgdir}/usr/lib/systemd/system/cups-browsed.service"

	chgrp -R lp "${pkgdir}/etc/cups"
}

sha512sums=('293fbaef1ec8b48f820fcba615ba989ebc31e6bbc8297936cf9b398046308d8637b29e732788294c12739b8e2c70755c189707e9db8a660c8231dba9afdcc3ab')

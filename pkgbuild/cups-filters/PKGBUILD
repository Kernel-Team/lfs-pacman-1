pkgname=cups-filters
pkgver=1.20.1
pkgrel=1
pkgdesc="OpenPrinting CUPS Filters"
arch=('x86_64')
url="https://wiki.linuxfoundation.org/openprinting/cups-filters"
license=('custom')
#depends=()
source=("https://www.openprinting.org/download/cups-filters/cups-filters-${pkgver}.tar.xz")

prepare() {
	cd "${srcdir}/cups-filters-${pkgver}"

	sed -i "s:cups.service:org.cups.cupsd.service:g" utils/cups-browsed.service
}

build() {
	cd "${srcdir}/cups-filters-${pkgver}"

	export CXX="${CXX} -std=c++11"

	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--localstatedir=/var \
		--without-rcdir \
		--enable-auto-setup-driverless

	make
}

package() {
	cd "${srcdir}/cups-filters-${pkgver}"

	make install DESTDIR="${pkgdir}"

	install -v -Dm644 utils/cups-browsed.service "${pkgdir}/usr/lib/systemd/system/cups-browsed.service"

	chgrp -R lp "${pkgdir}/etc/cups"
}

sha512sums=('9c0fc3c821a24db99a55b0d5e1750946b294e3b265edae4d4701b4bb3ff9d0f19cb282ff44ec8880a0f643a2703ea3419b03d3d32a5e045d86a2d37031cef108')

pkgname=gdm
pkgver=3.26.2.1
pkgrel=1
pkgdesc="Display manager and login screen"
arch=('x86_64')
url="https://wiki.gnome.org/Projects/GDM"
license=('GPL')
#depends=()
options=(emptydirs)
source=("https://download.gnome.org/sources/gdm/${pkgver:0:4}/gdm-${pkgver}.tar.xz"
	"gdm.sysusers")

build() {
	cd "${srcdir}/gdm-${pkgver}"

	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--localstatedir=/var \
		--disable-schemas-compile \
		--enable-gdm-xsession \
		--with-default-pam-config=lfs \
		--without-plymouth

	make
}

package() {
	cd "${srcdir}/gdm-${pkgver}"

	make install DESTDIR="${pkgdir}"

	chown -R 21:21 "${pkgdir}/var/lib/gdm"

	rm -rf "${pkgdir}"/var/{cache,log,run}

	install -v -Dm644 "${srcdir}/gdm.sysusers" "${pkgdir}/usr/lib/sysusers.d/gdm.conf"
}

sha512sums=('4a0009935f2f86803a4dd6cdc01c80c9ee89fb8a71f82ffa6fadb16322e4c7f51d82e0e887c30aa09d1b242c3cc82a1ec0d83463e5d8942719a747f6945cbec9'
            'afdfe702121ab9b9b64450e736a9d7fcd603a5c373e13e3a2ad6caa993fedca23b673d9bcaa3465e830f19bb6bc4c6c71d9f2699a57807f11d6706a97d190573')
